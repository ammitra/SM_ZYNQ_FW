# Zynq OS build
This directory holds the makefile for building the device-tree and kernel for the SM Zynq and then package those into the BOOT.BIN and image.ub files to be copied to /fw on the SM Zynq.

## device-tree
The device tree is generated from the output products of Vivado and other files from HDL both locally and remote (CM FW).
The non-Vivado information comes from dtsi_chunk and dtsi_post_chunk files and exist to mark IP and HDL AXI slaves as generic-uio devices so they can be interfaced via UIOuHAL software on the SoC.

 - dtsi_post_chunk:  This kind of file is used to modify Xilinx IP to have the generic-uio tag.  All other attributes are from the Vivado output files. 
 - dtsi_chunk: This kind of file describes an HDL or remote (via C2C) IP and specifies both the generic-uio tag and the AXI address and size of the slave. 

These files are stored in one of three folders:

 - ./hw : This is where output files generated by tcl script FW build infrastructure.   This folder is automatically cleaned when the FW is built to assure no stale files exist here. 
 - ./hw_user :  These are special files for HW like i2C slaves.  
 - ./hw_remote : This is where files from CM FW should be put. 

## Linux Kernel
The kernel used on the ApolloSM is a lightly modified petalinux kernl.
Modifications are located in "./zynq_os_mods"

## CentOS image
The filesystem for the ApolloSM is based on CentOS and is built in the ./centos/ directory.
Because this builds a full image for another machine, you are required to build it as root to assure file permissions. 
More details can be found in the Readme.md file in ./centos

